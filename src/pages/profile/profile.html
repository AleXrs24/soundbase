<!--
  Generated template for the Profile page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->







<ion-content class="card-background-page">
  <ion-navbar color="white">
    <ion-title>Perfil</ion-title>
  </ion-navbar>
  <ion-item no-lines>
    <ion-avatar item-left>
      <img class="profile-img" src="{{user.profile_image}}" />
    </ion-avatar>
    <h2>{{user.name}}</h2>
    <p>{{user.country}}</p>
    <div *ngIf="user.$key != currentUser" item-right>
      <button *ngIf="!isFollowed" ion-button small icon-left color="app" (click)="followUser(user.$key)">
        <ion-icon name="person-add" ></ion-icon>
        Seguir
      </button>
      <button *ngIf="isFollowed" ion-button small icon-left outline color="app" (click)="unFollowUser(user.$key)">
        <ion-icon name="done-all" ></ion-icon>
        Siguiendo
      </button>
    </div>
  </ion-item>

  <ion-toolbar color="white">
    <ion-segment [(ngModel)]="profile" color="app">
      <ion-segment-button value="tracks">
        <ion-icon name="musical-notes"></ion-icon>
      </ion-segment-button>

      <ion-segment-button value="lists">
        <ion-icon name="albums"></ion-icon>
      </ion-segment-button>

      <ion-segment-button value="data">
        <ion-icon name="information-circle"></ion-icon>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>

  <div [ngSwitch]="profile">
    <ion-list *ngSwitchCase="'tracks'">
      <ion-list-header>
        <h2>Pistas</h2>
      </ion-list-header>

      <ion-card *ngFor="let track of tracks_filter; let i = index">

        <img class="image" src="{{track.cover_page}}">
        <div class="card-title">{{track.title}}</div>
        <div class="card-subtitle">{{track.artist}}</div>
        <audio controls>
          <source src="{{track.audio}}" type="audio/mp3">
        </audio>
        <ion-card-content>

          <ion-note color="grey1">
            #{{track.tag}}
          </ion-note>

        </ion-card-content>

        <ion-row>
          <ion-col col-3>
            <button *ngIf="isLike[i]" color="grey2" ion-button icon-left clear (click)="disLikeTrack(track.$key)">
          <ion-icon color="danger" name="heart"></ion-icon>
          <div>{{track.likes}}</div>
        </button>
            <button *ngIf="!isLike[i]" color="grey2" ion-button icon-left clear (click)="likeTrack(track.$key)">
          <ion-icon name="heart"></ion-icon>
          <div>{{track.likes}}</div>
        </button>
          </ion-col>
          <ion-col col-3>
            <button *ngIf="isRepost[i]" color="grey2" ion-button icon-left clear (click)="unRepostTrack(track.$key)">
          <ion-icon color="app" name="repeat"></ion-icon>
          <div>{{track.reposts}}</div>
        </button>
            <button *ngIf="!isRepost[i]" color="grey2" ion-button icon-left clear (click)="repostTrack(track.$key)">
          <ion-icon name="repeat"></ion-icon>
          <div>{{track.reposts}}</div>
        </button>
          </ion-col>
          <ion-col col-3>
            <button color="grey2" ion-button icon-left clear (click)="comments(track.$key)">
          <ion-icon name="chatboxes"></ion-icon>
          <div>{{track.comments}}</div>
        </button>
          </ion-col>
          <ion-col col-3>
            <button color="grey2" ion-button icon-right clear (click)="more(track.$key, track.cover_page)">
          <ion-icon name="more"></ion-icon>
        </button>
          </ion-col>

        </ion-row>

      </ion-card>
    </ion-list>
    <ion-list *ngSwitchCase="'lists'">
      <ion-list-header>
        <h2>Listas</h2>
      </ion-list-header>

      <ion-card *ngFor="let list of lists" (click)="goToTracksList(list.$key, list.title)">

        <img class="image" src="{{list.coverpage}}">
        <div class="card-title-list">{{list.title}}</div>
        <div class="card-subtitle-list">{{list.creator}}</div>
        <div class="card-ntracks" *ngIf="list.ntracks == 1">{{list.ntracks}} PISTA</div>
        <div class="card-ntracks" *ngIf="list.ntracks != 1">{{list.ntracks}} PISTAS</div>

      </ion-card>
    </ion-list>

    <ion-list *ngSwitchCase="'data'">
      <ion-item (click)="viewUsers(user, 'Seguidores')">
        <h2>Seguidores</h2>
        <button color="app" item-right ion-button icon-right clear>
          <p>{{nfollowers}}</p>
          <ion-icon color="app" name="ios-arrow-forward"></ion-icon>
        </button>
      </ion-item>
      <ion-item (click)="viewUsers(user, 'Siguiendo')">
        <h2>Siguiendo</h2>
        <button color="app" item-right ion-button icon-right clear>
          <p>{{nfollowing}}</p>
          <ion-icon color="app" name="ios-arrow-forward"></ion-icon>
        </button>
      </ion-item>
    </ion-list>
  </div>
</ion-content>